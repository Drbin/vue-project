<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/echarts/4.1.0.rc2/echarts.js"></script>
    <script src="http://202.85.223.75:8090/zpark/lib/echarts-wordcloud.min.js"></script>
    <script src="http://202.85.223.75:8090/zpark/js/map/china.js"></script>
    <script src="http://202.85.223.75:8090/zpark/js/map/world.js"></script>
    <script src="http://202.85.223.75:8090/zpark/js/map/all-province.js"></script>

    <style>
        *{margin: 0;padding: 0;}
        body,html{ width: 100%; height: 100%;}
        .allDiv{ width: 100%; height: 100%; background-image: url("bg_temp.png");background-size: 100%; background-repeat: no-repeat; position: absolute; z-index:999 !important;box-sizing: border-box; padding: 50px 50px 140px 50px; }

        .flagMap{ width: 100%; height: 100%;}



    </style>
</head>
<body>


<div class="allDiv">
    <div id="createChinaMap" class="flagMap"></div>
</div>


<script>
    $.ajax({
        url:'http://202.85.223.75:8090/zpark/ZparkCooperateController/queryDomesticExtendCountByProvince',
        type:'GET',
        dataType:'json',
        success:function (res) {
            var a =[];
            for(var i=0;i<res.Data.length;i++){
                a.push({
                    'name':res.Data[i].key,
                    'value':res.Data[i].val
                })
            }
            createChinaMap(a)
        }
    })
    var colors=[
        "#20e49f",
        "#0bc785",
        "#5cc3f0",
        "#4189a9",
        "#28a9e1",
        "#6690f2",
        "#0d6a92",
        "#3469e4",
        "#4866ab",

    ];
    function createChinaMap(data) {
        var geoCoordMap = {};

        var mapFeatures = echarts.getMap('china').geoJson.features;
        mapFeatures.forEach(function(v) {
            // 地区名称
            var name = v.properties.name;
            // 地区经纬度
            geoCoordMap[name] = v.properties.cp;
        });

        var max = 480, //设置的气泡等大小的系数 //sad
            min = 9;
        var maxSize4Pin = 100, //设置的气泡等大小的系数
            minSize4Pin = 20; //设置的气泡等大小的系数

        var convertData = function(dt) {// 处理覆盖上面的点，得有经纬度，所以下面的value有经纬度
            var res = [];
            for (var i = 0; i < dt.length; i++) {
                var geoCoord = geoCoordMap[dt[i].name];
                if (geoCoord) {
                    res.push({
                        name: dt[i].name,
                        value: geoCoord.concat(dt[i].value),//这里把经纬度
                    });
                }
            }
            return res;
        };
        let option = {
            color:colors,
            backgroundColor: '',
            tooltip: {
            },
            visualMap: {
                max: 1000000,
                calculable: true,
                show:false,
                seriesIndex: [1],
                textStyle: {
                    color: '#fff',
                },
                inRange: {

                    color:['#1488CC', '#031525'] // 蓝绿

                },
            },
            geo: {
                show: true,
                map: 'china',
                label: {
                    normal: {
                        show: false
                    },
                    emphasis: {
                        show: false,
                    }
                },
                layoutCenter: ["50%", "50%"],
                layoutSize: "120%",
                roam: false, //是否可以放大缩小
                itemStyle: {


                }
            },
            series: [
                {
                    name: '点',
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    color:'#ffff00',
                    symbol: 'circle',

                    symbolSize: function(val) {
                        var a = 30;
                        var b = 30;

                        return 30

                    },
                    label: {
                        normal: {
                            show: true,
                            formatter: function(params) {
                                return params.data.value[2]
                            },
                            textStyle: {
                                color: '#fff',
                                fontSize: 15,
                            }
                        }
                    },
                    itemStyle: {
                        normal: {
                            color: '#ffff00',
                        }
                    },
                    zlevel: 6,
                    data: convertData(data),
                },
                {
                    type: 'map',
                    map: 'china',
                    geoIndex: 0,
                    aspectScale: 0.75, //长宽比
                    showLegendSymbol: false, // 存在legend时显示
                    label: {
                        normal: {
                            show: true
                        },
                        emphasis: {
                            show: false,
                            textStyle: {
                                color: '#fff'
                            }
                        }
                    },
                    roam: true,
                    itemStyle: {
                        normal: {
                            areaColor: '#031525',
                            borderColor: '#3B5077',
                        },
                        emphasis: {
                            areaColor: '#2B91B7'
                        }
                    },
                    animation: false,
                    data: data
                },

            ]
        }
        var myChart = echarts.init(document.getElementById('createChinaMap'));
        myChart.setOption(option);
    }

</script>
</body>
</html>